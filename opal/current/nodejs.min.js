Opal.modules["nodejs/kernel"]=function(Opal){Opal.top;var TMP_$$$eq_3,TMP_$$_4,$nesting=[],nil=Opal.nil,$module=(Opal.breaker,Opal.slice,Opal.module);return Opal.add_stubs(["$to_str","$new","$to_s"]),Opal.exit=process.exit,function($base,$parent_nesting){var TMP_Kernel_caller_1,TMP_Kernel_node_require_2,self=$module($base,"Kernel"),$nesting=(self.$$proto,[self].concat($parent_nesting));Opal.const_set($nesting[0],"NODE_REQUIRE",require),Opal.defn(self,"$caller",TMP_Kernel_caller_1=function($a_rest){var args,stack,$args_len=arguments.length,$rest_len=$args_len-0;$rest_len<0&&($rest_len=0),args=new Array($rest_len);for(var $arg_idx=0;$arg_idx<$args_len;$arg_idx++)args[$arg_idx-0]=arguments[$arg_idx];try{throw Error("my error")}catch(e){stack=e.stack}return stack.$split("\n").slice(3)},TMP_Kernel_caller_1.$$arity=-1),Opal.defn(self,"$node_require",TMP_Kernel_node_require_2=function(path){return Opal.const_get_relative($nesting,"NODE_REQUIRE")(path.$to_str())},TMP_Kernel_node_require_2.$$arity=1)}($nesting[0],$nesting),Opal.const_set($nesting[0],"ARGV",process.argv.slice(2)),Opal.const_set($nesting[0],"ENV",Opal.const_get_relative($nesting,"Object").$new()),Opal.defs(Opal.const_get_relative($nesting,"ENV"),"$[]=",TMP_$$$eq_3=function(name,value){return process.env[name.$to_s()]=value.$to_s()},TMP_$$$eq_3.$$arity=2),Opal.defs(Opal.const_get_relative($nesting,"ENV"),"$[]",TMP_$$_4=function(name){return process.env[name]||nil},TMP_$$_4.$$arity=1)},Opal.modules["nodejs/file"]=function(Opal){var self=Opal.top,$nesting=[],nil=Opal.nil,$klass=(Opal.breaker,Opal.slice,Opal.klass),$truthy=Opal.truthy;Opal.add_stubs(["$raise","$warn","$const_get","$new","$const_defined?","$const_set","$include","$node_require","$size","$respond_to?","$path","$join","$call","$exist?","$realpath","$!=","$close","$match","$gsub","$attr_reader"]);var errno_code,warnings={},errno_codes=["EACCES","EISDIR","EMFILE","ENOENT","EPERM"];function handle_unsupported_feature(message){switch(Opal.config.unsupported_features_severity){case"error":Opal.const_get_relative($nesting,"Kernel").$raise(Opal.const_get_relative($nesting,"NotImplementedError"),message);break;case"warning":!function(string){if(warnings[string])return;warnings[string]=!0,self.$warn(string)}(message)}}function executeIOAction(action){try{return action()}catch(error){if(errno_codes.indexOf(error.code)>=0)throw Opal.const_get_relative($nesting,"Errno").$const_get(error.code).$new(error.message);throw error}}for(var i=0,ii=errno_codes.length;i<ii;i++)errno_code=errno_codes[i],Opal.const_get_relative($nesting,"Errno")["$const_defined?"](errno_code)||Opal.const_get_relative($nesting,"Errno").$const_set(errno_code,Opal.const_get_relative($nesting,"Class").$new(Opal.const_get_relative($nesting,"SystemCallError")));return function($base,$super,$parent_nesting){function $File(){}var TMP_File_read_1,TMP_File_write_2,TMP_File_exist$q_3,TMP_File_realpath_4,TMP_File_join_5,TMP_File_directory$q_6,TMP_File_file$q_7,TMP_File_readable$q_8,TMP_File_size_9,TMP_File_open_10,TMP_File_stat_11,TMP_File_mtime_12,TMP_File_initialize_13,TMP_File_write_14,TMP_File_flush_15,TMP_File_close_16,TMP_File_mtime_17,self=$File=$klass($base,$super,"File",$File),def=self.$$proto,$nesting=[self].concat($parent_nesting);null==self.__fs__&&(self.__fs__=nil),null==self.__path__&&(self.__path__=nil),def.fd=def.path=nil,self.$include(Opal.const_get_qualified(Opal.const_get_qualified("::","IO"),"Writable")),self.$include(Opal.const_get_qualified(Opal.const_get_qualified("::","IO"),"Readable")),self.__fs__=self.$node_require("fs"),self.__path__=self.$node_require("path");var __fs__=self.__fs__,__path__=self.__path__;$truthy(__path__.sep!==Opal.const_get_relative($nesting,"Separator"))&&Opal.const_set($nesting[0],"ALT_SEPARATOR",__path__.sep),Opal.defs(self,"$read",TMP_File_read_1=function(path){return executeIOAction(function(){return __fs__.readFileSync(path).toString()})},TMP_File_read_1.$$arity=1),Opal.defs(self,"$write",TMP_File_write_2=function(path,data){return executeIOAction(function(){return __fs__.writeFileSync(path,data)}),data.$size()},TMP_File_write_2.$$arity=2),Opal.defs(self,"$exist?",TMP_File_exist$q_3=function(path){return $truthy(path["$respond_to?"]("path"))&&(path=path.$path()),executeIOAction(function(){return __fs__.existsSync(path)})},TMP_File_exist$q_3.$$arity=1),Opal.defs(self,"$realpath",TMP_File_realpath_4=function(pathname,dir_string,cache){var $iter=TMP_File_realpath_4.$$p,block=$iter||nil;return null==dir_string&&(dir_string=nil),null==cache&&(cache=nil),$iter&&(TMP_File_realpath_4.$$p=null),$truthy(dir_string)&&(pathname=this.$join(dir_string,pathname)),block!==nil?void 0:executeIOAction(function(){return __fs__.realpathSync(pathname,cache)})},TMP_File_realpath_4.$$arity=-2),Opal.defs(self,"$join",TMP_File_join_5=function($a_rest){var paths,$args_len=arguments.length,$rest_len=$args_len-0;$rest_len<0&&($rest_len=0),paths=new Array($rest_len);for(var $arg_idx=0;$arg_idx<$args_len;$arg_idx++)paths[$arg_idx-0]=arguments[$arg_idx];return __path__.join.apply(__path__,paths)},TMP_File_join_5.$$arity=-1),Opal.defs(self,"$directory?",TMP_File_directory$q_6=function(path){var result=nil,realpath=nil;return!!$truthy(this["$exist?"](path))&&(result=executeIOAction(function(){return!!__fs__.lstatSync(path).isDirectory()}),$truthy(result)||(realpath=this.$realpath(path),$truthy(realpath["$!="](path))&&(result=executeIOAction(function(){return!!__fs__.lstatSync(realpath).isDirectory()}))),result)},TMP_File_directory$q_6.$$arity=1),Opal.defs(self,"$file?",TMP_File_file$q_7=function(path){var result=nil,realpath=nil;return!!$truthy(this["$exist?"](path))&&(result=executeIOAction(function(){return!!__fs__.lstatSync(path).isFile()}),$truthy(result)||(realpath=this.$realpath(path),$truthy(realpath["$!="](path))&&(result=executeIOAction(function(){return!!__fs__.lstatSync(realpath).isFile()}))),result)},TMP_File_file$q_7.$$arity=1),Opal.defs(self,"$readable?",TMP_File_readable$q_8=function(path){return!!$truthy(this["$exist?"](path))&&"\n      try {\n        __fs__.accessSync(path, __fs__.R_OK);\n        return true;\n      } catch (error) {\n        return false;\n      }\n    "},TMP_File_readable$q_8.$$arity=1),Opal.defs(self,"$size",TMP_File_size_9=function(path){return executeIOAction(function(){return __fs__.lstatSync(path).size})},TMP_File_size_9.$$arity=1),Opal.defs(self,"$open",TMP_File_open_10=function(path,mode){var $iter=TMP_File_open_10.$$p,$yield=$iter||nil,file=nil;return null==mode&&(mode="r"),$iter&&(TMP_File_open_10.$$p=null),file=this.$new(path,mode),$yield!==nil?function(){try{return Opal.yield1($yield,file)}finally{file.$close()}}():file},TMP_File_open_10.$$arity=-2),Opal.defs(self,"$stat",TMP_File_stat_11=function(path){return $truthy(path["$respond_to?"]("path"))&&(path=path.$path()),Opal.const_get_qualified(Opal.const_get_relative($nesting,"File"),"Stat").$new(path)},TMP_File_stat_11.$$arity=1),Opal.defs(self,"$mtime",TMP_File_mtime_12=function(path){return executeIOAction(function(){return __fs__.statSync(path).mtime})},TMP_File_mtime_12.$$arity=1),Opal.defn(self,"$initialize",TMP_File_initialize_13=function(path,flags){var binary_flag_regexp,encoding_flag_regexp;return null==flags&&(flags="r"),binary_flag_regexp=/b/,encoding_flag_regexp=/:(.*)/,$truthy(flags.$match(binary_flag_regexp))&&handle_unsupported_feature("Binary flag (b) is unsupported by Node.js openSync method, removing flag."),flags=flags.$gsub(binary_flag_regexp,""),$truthy(flags.$match(encoding_flag_regexp))&&handle_unsupported_feature("Encoding flag (:encoding) is unsupported by Node.js openSync method, removing flag."),flags=flags.$gsub(encoding_flag_regexp,""),this.path=path,this.flags=flags,this.fd=executeIOAction(function(){return __fs__.openSync(path,flags)})},TMP_File_initialize_13.$$arity=-2),self.$attr_reader("path"),Opal.defn(self,"$write",TMP_File_write_14=function(string){var self=this;executeIOAction(function(){return __fs__.writeSync(self.fd,string)})},TMP_File_write_14.$$arity=1),Opal.defn(self,"$flush",TMP_File_flush_15=function(){var self=this;executeIOAction(function(){return __fs__.fsyncSync(self.fd)})},TMP_File_flush_15.$$arity=0),Opal.defn(self,"$close",TMP_File_close_16=function(){var self=this;executeIOAction(function(){return __fs__.closeSync(self.fd)})},TMP_File_close_16.$$arity=0),Opal.defn(self,"$mtime",TMP_File_mtime_17=function(){var self=this;return executeIOAction(function(){return __fs__.statSync(self.path).mtime})},TMP_File_mtime_17.$$arity=0)}($nesting[0],Opal.const_get_relative($nesting,"IO"),$nesting),function($base,$super,$parent_nesting){function $Stat(){}var TMP_Stat_initialize_18,TMP_Stat_file$q_19,TMP_Stat_mtime_20,self=$Stat=$klass($base,null,"Stat",$Stat),def=self.$$proto;[self].concat($parent_nesting);null==self.__fs__&&(self.__fs__=nil),def.path=nil,self.__fs__=self.$node_require("fs");var __fs__=self.__fs__;return Opal.defn(self,"$initialize",TMP_Stat_initialize_18=function(path){return this.path=path},TMP_Stat_initialize_18.$$arity=1),Opal.defn(self,"$file?",TMP_Stat_file$q_19=function(){var self=this;return executeIOAction(function(){return __fs__.statSync(self.path).isFile()})},TMP_Stat_file$q_19.$$arity=0),Opal.defn(self,"$mtime",TMP_Stat_mtime_20=function(){var self=this;return executeIOAction(function(){return __fs__.statSync(self.path).mtime})},TMP_Stat_mtime_20.$$arity=0),nil&&"mtime"}(Opal.const_get_relative($nesting,"File"),0,$nesting)},Opal.modules["nodejs/dir"]=function(Opal){Opal.top;var $nesting=[],nil=Opal.nil,$klass=(Opal.breaker,Opal.slice,Opal.klass);return Opal.add_stubs(["$node_require"]),function($base,$super,$parent_nesting){function $Dir(){}var self=$Dir=$klass($base,null,"Dir",$Dir),$nesting=(self.$$proto,[self].concat($parent_nesting));null==self.__glob__&&(self.__glob__=nil),null==self.__fs__&&(self.__fs__=nil),self.__glob__=self.$node_require("glob"),self.__fs__=self.$node_require("fs");var __glob__=self.__glob__,__fs__=self.__fs__;return function(self,$parent_nesting){var TMP_$$_1,TMP_pwd_2,TMP_mkdir_3,TMP_entries_4;self.$$proto,[self].concat($parent_nesting);return Opal.defn(self,"$[]",TMP_$$_1=function(glob){return __glob__.sync(glob)},TMP_$$_1.$$arity=1),Opal.defn(self,"$pwd",TMP_pwd_2=function(){return process.cwd()},TMP_pwd_2.$$arity=0),Opal.defn(self,"$mkdir",TMP_mkdir_3=function(path){return __fs__.mkdirSync(path)},TMP_mkdir_3.$$arity=1),Opal.defn(self,"$entries",TMP_entries_4=function(dirname){for(var result=[],entries=__fs__.readdirSync(dirname),i=0,ii=entries.length;i<ii;i++)result.push(entries[i]);return result},TMP_entries_4.$$arity=1),Opal.alias(self,"getwd","pwd")}(Opal.get_singleton_class(self),$nesting)}($nesting[0],0,$nesting)},Opal.modules["nodejs/io"]=function(Opal){function $rb_minus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs)}var TMP_7,TMP_8,self=Opal.top,$nesting=[],nil=Opal.nil,$klass=(Opal.breaker,Opal.slice,Opal.klass),$truthy=Opal.truthy,$gvars=Opal.gvars,$send=Opal.send,$writer=nil;function executeIOAction(action){try{return action()}catch(error){if("EACCES"===error.code||"EISDIR"===error.code||"EMFILE"===error.code||"ENOENT"===error.code||"EPERM"===error.code)throw Opal.IOError.$new(error.message);throw error}}return Opal.add_stubs(["$node_require","$attr_reader","$write","$read","$size","$to_enum","$chomp","$each_line","$lambda","$write_proc=","$-","$tty="]),function($base,$super,$parent_nesting){function $IO(){}var TMP_IO_initialize_1,TMP_IO_write_2,TMP_IO_read_3,TMP_IO_read_4,TMP_IO_each_line_5,TMP_IO_binread_6,self=$IO=$klass($base,null,"IO",$IO),def=self.$$proto,$nesting=[self].concat($parent_nesting);null==self.__fs__&&(self.__fs__=nil),def.eof=def.path=nil,self.__fs__=self.$node_require("fs");var __fs__=self.__fs__;self.$attr_reader("eof"),self.$attr_reader("lineno"),Opal.defn(self,"$initialize",TMP_IO_initialize_1=function(){return this.eof=!1,this.lineno=0},TMP_IO_initialize_1.$$arity=0),Opal.defs(self,"$write",TMP_IO_write_2=function(path,data){return Opal.const_get_relative($nesting,"File").$write(path,data)},TMP_IO_write_2.$$arity=2),Opal.defs(self,"$read",TMP_IO_read_3=function(path){return Opal.const_get_relative($nesting,"File").$read(path)},TMP_IO_read_3.$$arity=1),Opal.defn(self,"$read",TMP_IO_read_4=function(){var self=this,res=nil;return $truthy(self.eof)?"":(res=executeIOAction(function(){return __fs__.readFileSync(self.path).toString()}),self.eof=!0,self.lineno=res.$size(),res)},TMP_IO_read_4.$$arity=0),Opal.defn(self,"$each_line",TMP_IO_each_line_5=function(separator){var self=this,$iter=TMP_IO_each_line_5.$$p,block=$iter||nil,lines=nil;if(null==$gvars["/"]&&($gvars["/"]=nil),null==separator&&(separator=$gvars["/"]),$iter&&(TMP_IO_each_line_5.$$p=null),$truthy(self.eof))return block!==nil?self:[].$to_enum();if(block!==nil){lines=Opal.const_get_relative($nesting,"File").$read(self.path),self.eof=!1,self.lineno=0;for(var chomped=lines.$chomp(),trailing=lines.length!=chomped.length,splitted=chomped.split(separator),i=0,length=splitted.length;i<length;i++)self.lineno+=1,i<length-1||trailing?Opal.yield1(block,splitted[i]+separator):Opal.yield1(block,splitted[i]);return self.eof=!0,self}return self.$read().$each_line()},TMP_IO_each_line_5.$$arity=-1),Opal.defs(self,"$binread",TMP_IO_binread_6=function(path){return executeIOAction(function(){return __fs__.readFileSync(path).toString("binary")})},TMP_IO_binread_6.$$arity=1)}($nesting[0],0,$nesting),$writer=[$send(self,"lambda",[],(TMP_7=function(string){TMP_7.$$s;return null==string&&(string=nil),process.stdout.write(string)},TMP_7.$$s=self,TMP_7.$$arity=1,TMP_7))],$send(Opal.const_get_relative($nesting,"STDOUT"),"write_proc=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[$send(self,"lambda",[],(TMP_8=function(string){TMP_8.$$s;return null==string&&(string=nil),process.stderr.write(string)},TMP_8.$$s=self,TMP_8.$$arity=1,TMP_8))],$send(Opal.const_get_relative($nesting,"STDERR"),"write_proc=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[!0],$send(Opal.const_get_relative($nesting,"STDOUT"),"tty=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],$writer=[!0],$send(Opal.const_get_relative($nesting,"STDERR"),"tty=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]},Opal.modules.nodejs=function(Opal){var self=Opal.top,$nesting=[],$module=(Opal.nil,Opal.breaker,Opal.slice,Opal.module);return Opal.add_stubs(["$require"]),function($base,$parent_nesting){var self=$module($base,"NodeJS");self.$$proto,[self].concat($parent_nesting)}($nesting[0],$nesting),self.$require("nodejs/kernel"),self.$require("nodejs/file"),self.$require("nodejs/dir"),self.$require("nodejs/io")};
