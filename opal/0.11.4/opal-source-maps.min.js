Opal.modules.json=function(Opal){function $rb_minus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs)}Opal.top;var $nesting=[],nil=Opal.nil,$module=(Opal.breaker,Opal.slice,Opal.module),$klass=Opal.klass,$send=Opal.send,$truthy=Opal.truthy,$hash2=Opal.hash2;return Opal.add_stubs(["$raise","$new","$push","$[]=","$-","$[]","$create_id","$json_create","$const_get","$attr_accessor","$create_id=","$===","$parse","$generate","$from_object","$merge","$to_json","$responds_to?","$to_io","$write","$to_s","$to_a","$strftime"]),function($base,$parent_nesting){var TMP_JSON_$$_1,TMP_JSON_parse_2,TMP_JSON_parse$B_3,TMP_JSON_load_4,TMP_JSON_from_object_5,TMP_JSON_generate_6,TMP_JSON_dump_7,self=$module($base,"JSON"),$nesting=(self.$$proto,[self].concat($parent_nesting)),$writer=nil;!function($base,$super,$parent_nesting){function $JSONError(){}var self=$JSONError=$klass($base,$super,"JSONError",$JSONError);self.$$proto,[self].concat($parent_nesting)}($nesting[0],Opal.const_get_relative($nesting,"StandardError"),$nesting),function($base,$super,$parent_nesting){function $ParserError(){}var self=$ParserError=$klass($base,$super,"ParserError",$ParserError);self.$$proto,[self].concat($parent_nesting)}($nesting[0],Opal.const_get_relative($nesting,"JSONError"),$nesting);var $hasOwn=Opal.hasOwnProperty;function $parse(source){try{return JSON.parse(source)}catch(e){self.$raise(Opal.const_get_qualified(Opal.const_get_relative($nesting,"JSON"),"ParserError"),e.message)}}function to_opal(value,options){var klass,arr,hash,i,ii,k;switch(typeof value){case"string":case"number":return value;case"boolean":return!!value;case"null":return nil;case"object":if(!value)return nil;if(value.$$is_array){for(arr=options.array_class.$new(),i=0,ii=value.length;i<ii;i++)arr.$push(to_opal(value[i],options));return arr}for(k in hash=options.object_class.$new(),value)$hasOwn.call(value,k)&&($writer=[k,to_opal(value[k],options)],$send(hash,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]);return options.parse||(klass=hash["$[]"](Opal.const_get_relative($nesting,"JSON").$create_id()))==nil?hash:Opal.const_get_qualified("::","Object").$const_get(klass).$json_create(hash)}}!function(self,$parent_nesting){self.$$proto,[self].concat($parent_nesting);self.$attr_accessor("create_id")}(Opal.get_singleton_class(self),$nesting),$writer=["json_class"],$send(self,"create_id=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],Opal.defs(self,"$[]",TMP_JSON_$$_1=function(value,options){return null==options&&(options=$hash2([],{})),$truthy(Opal.const_get_relative($nesting,"String")["$==="](value))?this.$parse(value,options):this.$generate(value,options)},TMP_JSON_$$_1.$$arity=-2),Opal.defs(self,"$parse",TMP_JSON_parse_2=function(source,options){return null==options&&(options=$hash2([],{})),this.$from_object($parse(source),options.$merge($hash2(["parse"],{parse:!0})))},TMP_JSON_parse_2.$$arity=-2),Opal.defs(self,"$parse!",TMP_JSON_parse$B_3=function(source,options){return null==options&&(options=$hash2([],{})),this.$parse(source,options)},TMP_JSON_parse$B_3.$$arity=-2),Opal.defs(self,"$load",TMP_JSON_load_4=function(source,options){return null==options&&(options=$hash2([],{})),this.$from_object($parse(source),options)},TMP_JSON_load_4.$$arity=-2),Opal.defs(self,"$from_object",TMP_JSON_from_object_5=function(js_object,options){var $writer=nil;return null==options&&(options=$hash2([],{})),$truthy(options["$[]"]("object_class"))||($writer=["object_class",Opal.const_get_relative($nesting,"Hash")],$send(options,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]),$truthy(options["$[]"]("array_class"))||($writer=["array_class",Opal.const_get_relative($nesting,"Array")],$send(options,"[]=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)]),to_opal(js_object,options.$$smap)},TMP_JSON_from_object_5.$$arity=-2),Opal.defs(self,"$generate",TMP_JSON_generate_6=function(obj,options){return null==options&&(options=$hash2([],{})),obj.$to_json(options)},TMP_JSON_generate_6.$$arity=-2),Opal.defs(self,"$dump",TMP_JSON_dump_7=function(obj,io,limit){var string;return null==io&&(io=nil),null==limit&&(limit=nil),string=this.$generate(obj),$truthy(io)?($truthy(io["$responds_to?"]("to_io"))&&(io=io.$to_io()),io.$write(string),io):string},TMP_JSON_dump_7.$$arity=-2)}($nesting[0],$nesting),function($base,$super,$parent_nesting){function $Object(){}var TMP_Object_to_json_8,self=$Object=$klass($base,null,"Object",$Object);self.$$proto,[self].concat($parent_nesting);Opal.defn(self,"$to_json",TMP_Object_to_json_8=function(){return this.$to_s().$to_json()},TMP_Object_to_json_8.$$arity=0)}($nesting[0],0,$nesting),function($base,$parent_nesting){var TMP_Enumerable_to_json_9,self=$module($base,"Enumerable");self.$$proto,[self].concat($parent_nesting);Opal.defn(self,"$to_json",TMP_Enumerable_to_json_9=function(){return this.$to_a().$to_json()},TMP_Enumerable_to_json_9.$$arity=0)}($nesting[0],$nesting),function($base,$super,$parent_nesting){function $Array(){}var TMP_Array_to_json_10,self=$Array=$klass($base,null,"Array",$Array);self.$$proto,[self].concat($parent_nesting);Opal.defn(self,"$to_json",TMP_Array_to_json_10=function(){for(var result=[],i=0,length=this.length;i<length;i++)result.push(this[i].$to_json());return"["+result.join(", ")+"]"},TMP_Array_to_json_10.$$arity=0)}($nesting[0],0,$nesting),function($base,$super,$parent_nesting){function $Boolean(){}var TMP_Boolean_to_json_11,self=$Boolean=$klass($base,null,"Boolean",$Boolean);self.$$proto,[self].concat($parent_nesting);Opal.defn(self,"$to_json",TMP_Boolean_to_json_11=function(){return 1==this?"true":"false"},TMP_Boolean_to_json_11.$$arity=0)}($nesting[0],0,$nesting),function($base,$super,$parent_nesting){function $Hash(){}var TMP_Hash_to_json_12,self=$Hash=$klass($base,null,"Hash",$Hash);self.$$proto,[self].concat($parent_nesting);Opal.defn(self,"$to_json",TMP_Hash_to_json_12=function(){for(var key,value,result=[],i=0,keys=this.$$keys,length=keys.length;i<length;i++)(key=keys[i]).$$is_string?value=this.$$smap[key]:(value=key.value,key=key.key),result.push(key.$to_s().$to_json()+":"+value.$to_json());return"{"+result.join(", ")+"}"},TMP_Hash_to_json_12.$$arity=0)}($nesting[0],0,$nesting),function($base,$super,$parent_nesting){function $NilClass(){}var TMP_NilClass_to_json_13,self=$NilClass=$klass($base,null,"NilClass",$NilClass);self.$$proto,[self].concat($parent_nesting);Opal.defn(self,"$to_json",TMP_NilClass_to_json_13=function(){return"null"},TMP_NilClass_to_json_13.$$arity=0)}($nesting[0],0,$nesting),function($base,$super,$parent_nesting){function $Numeric(){}var TMP_Numeric_to_json_14,self=$Numeric=$klass($base,null,"Numeric",$Numeric);self.$$proto,[self].concat($parent_nesting);Opal.defn(self,"$to_json",TMP_Numeric_to_json_14=function(){return this.toString()},TMP_Numeric_to_json_14.$$arity=0)}($nesting[0],0,$nesting),function($base,$super,$parent_nesting){function $String(){}var self=$String=$klass($base,null,"String",$String);self.$$proto,[self].concat($parent_nesting);Opal.alias(self,"to_json","inspect")}($nesting[0],0,$nesting),function($base,$super,$parent_nesting){function $Time(){}var TMP_Time_to_json_15,self=$Time=$klass($base,null,"Time",$Time);self.$$proto,[self].concat($parent_nesting);Opal.defn(self,"$to_json",TMP_Time_to_json_15=function(){return this.$strftime("%FT%T%z").$to_json()},TMP_Time_to_json_15.$$arity=0)}($nesting[0],0,$nesting),function($base,$super,$parent_nesting){function $Date(){}var TMP_Date_to_json_16,TMP_Date_as_json_17,self=$Date=$klass($base,null,"Date",$Date);self.$$proto,[self].concat($parent_nesting);return Opal.defn(self,"$to_json",TMP_Date_to_json_16=function(){return this.$to_s().$to_json()},TMP_Date_to_json_16.$$arity=0),Opal.defn(self,"$as_json",TMP_Date_as_json_17=function(){return this.$to_s()},TMP_Date_as_json_17.$$arity=0),nil&&"as_json"}($nesting[0],0,$nesting)},Opal.modules["source_map/offset"]=function(Opal){function $rb_plus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs+rhs:lhs["$+"](rhs)}function $rb_minus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs)}Opal.top;var $nesting=[],nil=Opal.nil,$module=(Opal.breaker,Opal.slice,Opal.module),$klass=Opal.klass,$send=Opal.send,$truthy=Opal.truthy;return Opal.add_stubs(["$include","$first","$===","$attr_reader","$new","$+","$line","$column","$raise","$class","$-","$zero?","$=="]),function($base,$parent_nesting){var self=$module($base,"SourceMap"),$nesting=(self.$$proto,[self].concat($parent_nesting));!function($base,$super,$parent_nesting){function $Offset(){}var TMP_Offset_new_1,TMP_Offset_initialize_2,TMP_Offset_$_3,TMP_Offset_$lt$eq$gt_4,TMP_Offset_to_s_5,TMP_Offset_inspect_6,self=$Offset=$klass($base,null,"Offset",$Offset),$nesting=(self.$$proto,[self].concat($parent_nesting));self.$include(Opal.const_get_relative($nesting,"Comparable")),Opal.defs(self,"$new",TMP_Offset_new_1=function($a_rest){var args,self=this,$iter=TMP_Offset_new_1.$$p,$case=nil,$args_len=arguments.length,$rest_len=$args_len-0;$rest_len<0&&($rest_len=0),args=new Array($rest_len);for(var $arg_idx=0;$arg_idx<$args_len;$arg_idx++)args[$arg_idx-0]=arguments[$arg_idx];return $iter&&(TMP_Offset_new_1.$$p=null),$case=args.$first(),Opal.const_get_relative($nesting,"Offset")["$==="]($case)?args.$first():Opal.const_get_relative($nesting,"Array")["$==="]($case)?$send(self,Opal.find_super_dispatcher(self,"new",TMP_Offset_new_1,!1,$Offset),Opal.to_a(args.$first()),null):$send(self,Opal.find_super_dispatcher(self,"new",TMP_Offset_new_1,!1,$Offset),Opal.to_a(args),null)},TMP_Offset_new_1.$$arity=-1),Opal.defn(self,"$initialize",TMP_Offset_initialize_2=function(line,column){var $a;return $a=[line,column],this.line=$a[0],this.column=$a[1],$a},TMP_Offset_initialize_2.$$arity=2),self.$attr_reader("line"),self.$attr_reader("column"),Opal.defn(self,"$+",TMP_Offset_$_3=function(other){var self=this,$case=nil;return $case=other,Opal.const_get_relative($nesting,"Offset")["$==="]($case)?Opal.const_get_relative($nesting,"Offset").$new($rb_plus(self.$line(),other.$line()),$rb_plus(self.$column(),other.$column())):Opal.const_get_relative($nesting,"Integer")["$==="]($case)?Opal.const_get_relative($nesting,"Offset").$new($rb_plus(self.$line(),other),self.$column()):self.$raise(Opal.const_get_relative($nesting,"ArgumentError"),"can't convert "+other+" into "+self.$class())},TMP_Offset_$_3.$$arity=1),Opal.defn(self,"$<=>",TMP_Offset_$lt$eq$gt_4=function(other){var self=this,$case=nil,diff=nil;return $case=other,Opal.const_get_relative($nesting,"Offset")["$==="]($case)?(diff=$rb_minus(self.$line(),other.$line()),$truthy(diff["$zero?"]())?$rb_minus(self.$column(),other.$column()):diff):self.$raise(Opal.const_get_relative($nesting,"ArgumentError"),"can't convert "+other.$class()+" into "+self.$class())},TMP_Offset_$lt$eq$gt_4.$$arity=1),Opal.defn(self,"$to_s",TMP_Offset_to_s_5=function(){return this.$column()["$=="](0)?""+this.$line():this.$line()+":"+this.$column()},TMP_Offset_to_s_5.$$arity=0),Opal.defn(self,"$inspect",TMP_Offset_inspect_6=function(){return"#<"+this.$class()+" line="+this.$line()+", column="+this.$column()+">"},TMP_Offset_inspect_6.$$arity=0)}($nesting[0],0,$nesting)}($nesting[0],$nesting)},Opal.modules["source_map/mapping"]=function(Opal){var self=Opal.top,$nesting=[],nil=Opal.nil,$module=(Opal.breaker,Opal.slice,Opal.module),$klass=Opal.klass,$truthy=Opal.truthy;return Opal.add_stubs(["$require","$line","$generated","$column","$<<","$source","$original","$name","$class","$inspect","$new"]),self.$require("source_map/offset"),function($base,$parent_nesting){var self=$module($base,"SourceMap"),$nesting=(self.$$proto,[self].concat($parent_nesting));!function($base,$super,$parent_nesting){function $Mapping(){}var TMP_Mapping_to_s_1,TMP_Mapping_inspect_2,self=$Mapping=$klass($base,$super,"Mapping",$Mapping);self.$$proto,[self].concat($parent_nesting);Opal.defn(self,"$to_s",TMP_Mapping_to_s_1=function(){var str=nil;return(str=this.$generated().$line()+":"+this.$generated().$column())["$<<"]("->"+this.$source()+"@"+this.$original().$line()+":"+this.$original().$column()),$truthy(this.$name())&&str["$<<"]("#"+this.$name()),str},TMP_Mapping_to_s_1.$$arity=0),Opal.defn(self,"$inspect",TMP_Mapping_inspect_2=function(){var str=nil;return(str="#<"+this.$class()+" source="+this.$source().$inspect())["$<<"](" generated="+this.$generated()+", original="+this.$original()),$truthy(this.$name())&&str["$<<"](" name="+this.$name().$inspect()),str["$<<"](">"),str},TMP_Mapping_inspect_2.$$arity=0)}($nesting[0],Opal.const_get_relative($nesting,"Struct").$new("source","generated","original","name"),$nesting)}($nesting[0],$nesting)},Opal.modules["source_map/vlq"]=function(Opal){function $rb_minus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs)}function $rb_plus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs+rhs:lhs["$+"](rhs)}function $rb_gt(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs>rhs:lhs["$>"](rhs)}Opal.top;var $nesting=[],nil=Opal.nil,$module=(Opal.breaker,Opal.slice,Opal.module),$send=Opal.send,$range=Opal.range,$hash2=Opal.hash2,$truthy=Opal.truthy;return Opal.add_stubs(["$<<","$-","$split","$inject","$[]","$[]=","$each","$<","$+","$-@","$loop","$&","$>>","$>","$|","$join","$any?","$shift","$raise","$==","$map","$encode","$each_with_index","$decode"]),function($base,$parent_nesting){var self=$module($base,"SourceMap"),$nesting=(self.$$proto,[self].concat($parent_nesting));!function($base,$parent_nesting){var TMP_VLQ_1,TMP_VLQ_encode_4,TMP_VLQ_decode_5,TMP_VLQ_encode_mappings_8,TMP_VLQ_decode_mappings_11,self=$module($base,"VLQ"),$nesting=(self.$$proto,[self].concat($parent_nesting));Opal.const_set($nesting[0],"VLQ_BASE_SHIFT",5),Opal.const_set($nesting[0],"VLQ_BASE",1["$<<"](Opal.const_get_relative($nesting,"VLQ_BASE_SHIFT"))),Opal.const_set($nesting[0],"VLQ_BASE_MASK",$rb_minus(Opal.const_get_relative($nesting,"VLQ_BASE"),1)),Opal.const_set($nesting[0],"VLQ_CONTINUATION_BIT",Opal.const_get_relative($nesting,"VLQ_BASE")),Opal.const_set($nesting[0],"BASE64_DIGITS","ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".$split("")),Opal.const_set($nesting[0],"BASE64_VALUES",$send($range(0,64,!0),"inject",[$hash2([],{})],((TMP_VLQ_1=function(h,i){var $writer;TMP_VLQ_1.$$s;return null==h&&(h=nil),null==i&&(i=nil),$writer=[Opal.const_get_relative($nesting,"BASE64_DIGITS")["$[]"](i),i],$send(h,"[]=",Opal.to_a($writer)),$rb_minus($writer.length,1),h}).$$s=self,TMP_VLQ_1.$$arity=2,TMP_VLQ_1))),Opal.defs(self,"$encode",TMP_VLQ_encode_4=function(ary){var TMP_2,self=this,result=nil;return result=[],function(){var $brk=Opal.new_brk();try{$send(ary,"each",[],((TMP_2=function(n){var TMP_3,lhs,rhs,self=TMP_2.$$s||this,vlq=nil;return null==n&&(n=nil),vlq=$truthy((rhs=0,"number"==typeof(lhs=n)&&"number"==typeof rhs?lhs<rhs:lhs["$<"](rhs)))?$rb_plus(n["$-@"]()["$<<"](1),1):n["$<<"](1),function(){var $brk=Opal.new_brk();try{return $send(self,"loop",[],((TMP_3=function(){TMP_3.$$s;var digit=nil;if(digit=vlq["$&"](Opal.const_get_relative($nesting,"VLQ_BASE_MASK")),vlq=vlq["$>>"](Opal.const_get_relative($nesting,"VLQ_BASE_SHIFT")),$truthy($rb_gt(vlq,0))&&(digit=digit["$|"](Opal.const_get_relative($nesting,"VLQ_CONTINUATION_BIT"))),result["$<<"](Opal.const_get_relative($nesting,"BASE64_DIGITS")["$[]"](digit)),$truthy($rb_gt(vlq,0)))return nil;Opal.brk(nil,$brk)}).$$s=self,TMP_3.$$brk=$brk,TMP_3.$$arity=0,TMP_3))}catch(err){if(err===$brk)return err.$v;throw err}}()}).$$s=self,TMP_2.$$brk=$brk,TMP_2.$$arity=1,TMP_2))}catch(err){if(err===$brk)return err.$v;throw err}}(),result.$join()},TMP_VLQ_encode_4.$$arity=1),Opal.defs(self,"$decode",TMP_VLQ_decode_5=function(str){var result=nil,chars=nil,vlq=nil,shift=nil,continuation=nil,char$=nil,digit=nil;for(result=[],chars=str.$split("");$truthy(chars["$any?"]());){for(vlq=0,shift=0,continuation=!0;$truthy(continuation);)char$=chars.$shift(),$truthy(char$)||this.$raise(Opal.const_get_relative($nesting,"ArgumentError")),(digit=Opal.const_get_relative($nesting,"BASE64_VALUES")["$[]"](char$))["$&"](Opal.const_get_relative($nesting,"VLQ_CONTINUATION_BIT"))["$=="](0)&&(continuation=!1),digit=digit["$&"](Opal.const_get_relative($nesting,"VLQ_BASE_MASK")),vlq=$rb_plus(vlq,digit["$<<"](shift)),shift=$rb_plus(shift,Opal.const_get_relative($nesting,"VLQ_BASE_SHIFT"));result["$<<"](vlq["$&"](1)["$=="](1)?vlq["$>>"](1)["$-@"]():vlq["$>>"](1))}return result},TMP_VLQ_decode_5.$$arity=1),Opal.defs(self,"$encode_mappings",TMP_VLQ_encode_mappings_8=function(ary){var TMP_6;return $send(ary,"map",[],(TMP_6=function(group){var TMP_7,self=TMP_6.$$s||this;return null==group&&(group=nil),$send(group,"map",[],(TMP_7=function(segment){var self=TMP_7.$$s||this;return null==segment&&(segment=nil),self.$encode(segment)},TMP_7.$$s=self,TMP_7.$$arity=1,TMP_7)).$join(",")},TMP_6.$$s=this,TMP_6.$$arity=1,TMP_6)).$join(";")},TMP_VLQ_encode_mappings_8.$$arity=1),Opal.defs(self,"$decode_mappings",TMP_VLQ_decode_mappings_11=function(str){var TMP_9,mappings=nil;return mappings=[],$send(str.$split(";"),"each_with_index",[],((TMP_9=function(group,index){var TMP_10,$writer,self=TMP_9.$$s||this;return null==group&&(group=nil),null==index&&(index=nil),$writer=[index,[]],$send(mappings,"[]=",Opal.to_a($writer)),$rb_minus($writer.length,1),$send(group.$split(","),"each",[],((TMP_10=function(segment){var self=TMP_10.$$s||this;return null==segment&&(segment=nil),mappings["$[]"](index)["$<<"](self.$decode(segment))}).$$s=self,TMP_10.$$arity=1,TMP_10))}).$$s=this,TMP_9.$$arity=2,TMP_9)),mappings},TMP_VLQ_decode_mappings_11.$$arity=1)}($nesting[0],$nesting)}($nesting[0],$nesting)},Opal.modules["source_map/map"]=function(Opal){function $rb_plus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs+rhs:lhs["$+"](rhs)}function $rb_gt(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs>rhs:lhs["$>"](rhs)}function $rb_lt(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs<rhs:lhs["$<"](rhs)}function $rb_minus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs)}var self=Opal.top,$nesting=[],nil=Opal.nil,$module=(Opal.breaker,Opal.slice,Opal.module),$klass=Opal.klass,$send=Opal.send,$truthy=Opal.truthy,$hash2=Opal.hash2;return Opal.add_stubs(["$require","$include","$from_hash","$parse","$[]","$decode_vlq_mappings","$new","$each_with_index","$decode_mappings","$+","$each","$>=","$size","$<<","$attr_reader","$to_proc","$build_vlq_string","$compact","$uniq","$map","$eql?","$is_a?","$class","$==","$mappings","$filename","$dup","$any?","$line","$generated","$last","$source","$original","$name","$empty?","$bsearch","$/","$>","$<","$-","$to_s","$sources","$names","$inspect","$protected","$group_by","$to_a","$max","$keys","$column","$encode_mappings"]),self.$require("json"),self.$require("source_map/offset"),self.$require("source_map/mapping"),self.$require("source_map/vlq"),function($base,$parent_nesting){var self=$module($base,"SourceMap"),$nesting=(self.$$proto,[self].concat($parent_nesting));!function($base,$super,$parent_nesting){function $Map(){}var TMP_Map_from_json_1,TMP_Map_from_hash_2,TMP_Map_decode_vlq_mappings_5,TMP_Map_initialize_6,TMP_Map_size_7,TMP_Map_$$_8,TMP_Map_each_9,TMP_Map_to_s_10,TMP_Map_sources_11,TMP_Map_names_12,TMP_Map_$eq$eq_13,TMP_Map_eql$q_14,TMP_Map_$_16,TMP_Map_$_18,TMP_Map_bsearch_19,TMP_Map_as_json_20,TMP_Map_inspect_21,TMP_Map_build_vlq_string_25,self=$Map=$klass($base,null,"Map",$Map),def=self.$$proto,$nesting=[self].concat($parent_nesting);def.mappings=def.string=def.sources=def.names=nil,self.$include(Opal.const_get_relative($nesting,"Enumerable")),Opal.defs(self,"$from_json",TMP_Map_from_json_1=function(json){return this.$from_hash(Opal.const_get_relative($nesting,"JSON").$parse(json))},TMP_Map_from_json_1.$$arity=1),Opal.defs(self,"$from_hash",TMP_Map_from_hash_2=function(hash){var str,sources,names,mappings;return str=hash["$[]"]("mappings"),sources=hash["$[]"]("sources"),names=hash["$[]"]("names"),mappings=this.$decode_vlq_mappings(str,sources,names),this.$new(mappings,hash["$[]"]("file"))},TMP_Map_from_hash_2.$$arity=1),Opal.defs(self,"$decode_vlq_mappings",TMP_Map_decode_vlq_mappings_5=function(str,sources,names){var TMP_3,mappings=nil,source_id=nil,original_line=nil,original_column=nil,name_id=nil;return null==sources&&(sources=[]),null==names&&(names=[]),mappings=[],source_id=0,original_line=1,original_column=0,name_id=0,$send(Opal.const_get_relative($nesting,"VLQ").$decode_mappings(str),"each_with_index",[],((TMP_3=function(group,index){var TMP_4,generated_line,self=TMP_3.$$s||this,generated_column=nil;return null==group&&(group=nil),null==index&&(index=nil),generated_column=0,generated_line=$rb_plus(index,1),$send(group,"each",[],((TMP_4=function(segment){TMP_4.$$s;var generated,lhs,rhs,source=nil,original=nil,name=nil;return null==segment&&(segment=nil),generated_column=$rb_plus(generated_column,segment["$[]"](0)),generated=Opal.const_get_relative($nesting,"Offset").$new(generated_line,generated_column),$truthy((lhs=segment.$size(),rhs=4,"number"==typeof lhs&&"number"==typeof rhs?lhs>=rhs:lhs["$>="](rhs)))?(source_id=$rb_plus(source_id,segment["$[]"](1)),original_line=$rb_plus(original_line,segment["$[]"](2)),original_column=$rb_plus(original_column,segment["$[]"](3)),source=sources["$[]"](source_id),original=Opal.const_get_relative($nesting,"Offset").$new(original_line,original_column),$truthy(segment["$[]"](4))&&(name_id=$rb_plus(name_id,segment["$[]"](4)),name=names["$[]"](name_id)),mappings["$<<"](Opal.const_get_relative($nesting,"Mapping").$new(source,generated,original,name))):nil}).$$s=self,TMP_4.$$arity=1,TMP_4))}).$$s=this,TMP_3.$$arity=2,TMP_3)),mappings},TMP_Map_decode_vlq_mappings_5.$$arity=-2),Opal.defn(self,"$initialize",TMP_Map_initialize_6=function(mappings,filename){var $a;return null==mappings&&(mappings=[]),null==filename&&(filename=nil),$a=[mappings,filename],this.mappings=$a[0],this.filename=$a[1],$a},TMP_Map_initialize_6.$$arity=-1),self.$attr_reader("filename"),Opal.defn(self,"$size",TMP_Map_size_7=function(){return this.mappings.$size()},TMP_Map_size_7.$$arity=0),Opal.defn(self,"$[]",TMP_Map_$$_8=function(i){return this.mappings["$[]"](i)},TMP_Map_$$_8.$$arity=1),Opal.defn(self,"$each",TMP_Map_each_9=function(){var $iter=TMP_Map_each_9.$$p,block=$iter||nil;return $iter&&(TMP_Map_each_9.$$p=null),$send(this.mappings,"each",[],block.$to_proc())},TMP_Map_each_9.$$arity=0),Opal.defn(self,"$to_s",TMP_Map_to_s_10=function(){var $a;return this.string=$truthy($a=this.string)?$a:this.$build_vlq_string()},TMP_Map_to_s_10.$$arity=0),Opal.defn(self,"$sources",TMP_Map_sources_11=function(){var $a;return this.sources=$truthy($a=this.sources)?$a:$send(this.mappings,"map",[],"source".$to_proc()).$uniq().$compact()},TMP_Map_sources_11.$$arity=0),Opal.defn(self,"$names",TMP_Map_names_12=function(){var $a;return this.names=$truthy($a=this.names)?$a:$send(this.mappings,"map",[],"name".$to_proc()).$uniq().$compact()},TMP_Map_names_12.$$arity=0),Opal.defn(self,"$==",TMP_Map_$eq$eq_13=function(other){return this["$eql?"](other)},TMP_Map_$eq$eq_13.$$arity=1),Opal.defn(self,"$eql?",TMP_Map_eql$q_14=function(other){var $a,$b;return $truthy($a=$truthy($b=other["$is_a?"](this.$class()))?this.$mappings()["$=="](other.$mappings()):$b)?this.$filename()["$=="](other.$filename()):$a},TMP_Map_eql$q_14.$$arity=1),Opal.defn(self,"$+",TMP_Map_$_16=function(other){var TMP_15,offset,self=this,mappings=nil;return mappings=self.mappings.$dup(),offset=$truthy(self.mappings["$any?"]())?$rb_plus(self.mappings.$last().$generated().$line(),1):0,$send(other,"each",[],((TMP_15=function(m){TMP_15.$$s;return null==m&&(m=nil),mappings["$<<"](Opal.const_get_relative($nesting,"Mapping").$new(m.$source(),$rb_plus(m.$generated(),offset),m.$original(),m.$name()))}).$$s=self,TMP_15.$$arity=1,TMP_15)),self.$class().$new(mappings,other.$filename())},TMP_Map_$_16.$$arity=1),Opal.defn(self,"$|",TMP_Map_$_18=function(other){var TMP_17,mappings=nil;return $truthy(this.$mappings()["$empty?"]())?other.$dup():(mappings=[],$send(other,"each",[],((TMP_17=function(m){var self=TMP_17.$$s||this,om=nil;return null==m&&(m=nil),om=self.$bsearch(m.$original()),$truthy(om)?mappings["$<<"](Opal.const_get_relative($nesting,"Mapping").$new(om.$source(),m.$generated(),om.$original(),om.$name())):nil}).$$s=this,TMP_17.$$arity=1,TMP_17)),this.$class().$new(mappings,other.$filename()))},TMP_Map_$_18.$$arity=1),Opal.defn(self,"$bsearch",TMP_Map_bsearch_19=function(offset,from,to){var lhs,rhs,self=this,mid=nil;return null==from&&(from=0),null==to&&(to=$rb_minus(self.$size(),1)),lhs=$rb_plus(from,to),rhs=2,mid="number"==typeof lhs&&"number"==typeof rhs?lhs/rhs:lhs["$/"](rhs),$truthy($rb_gt(from,to))?$truthy($rb_lt(from,1))?nil:self["$[]"]($rb_minus(from,1)):offset["$=="](self["$[]"](mid).$generated())?self["$[]"](mid):$truthy($rb_lt(offset,self["$[]"](mid).$generated()))?self.$bsearch(offset,from,$rb_minus(mid,1)):$truthy($rb_gt(offset,self["$[]"](mid).$generated()))?self.$bsearch(offset,$rb_plus(mid,1),to):nil},TMP_Map_bsearch_19.$$arity=-2),Opal.defn(self,"$as_json",TMP_Map_as_json_20=function(){return $hash2(["version","file","mappings","sources","names"],{version:3,file:this.$filename(),mappings:this.$to_s(),sources:this.$sources(),names:this.$names()})},TMP_Map_as_json_20.$$arity=0),Opal.defn(self,"$inspect",TMP_Map_inspect_21=function(){var str=nil;return str="#<"+this.$class(),$truthy(this.$filename())&&str["$<<"](" filename="+this.$filename().$inspect()),$truthy(this.$mappings()["$any?"]())&&str["$<<"](" mappings="+$send(this.$mappings(),"map",[],"to_s".$to_proc()).$inspect()),str["$<<"](">"),str},TMP_Map_inspect_21.$$arity=0),self.$protected(),self.$attr_reader("mappings"),Opal.defn(self,"$build_vlq_string",TMP_Map_build_vlq_string_25=function(){var TMP_22,$a,TMP_23,ary,source_id=nil,source_line=nil,source_column=nil,name_id=nil,by_lines=nil,sources_index=nil,names_index=nil;return source_id=0,source_line=1,source_column=0,name_id=0,by_lines=$send(this.mappings,"group_by",[],((TMP_22=function(m){TMP_22.$$s;return null==m&&(m=nil),m.$generated().$line()}).$$s=this,TMP_22.$$arity=1,TMP_22)),sources_index=Opal.const_get_relative($nesting,"Hash")["$[]"](this.$sources().$each_with_index().$to_a()),names_index=Opal.const_get_relative($nesting,"Hash")["$[]"](this.$names().$each_with_index().$to_a()),ary=$send(Opal.Range.$new(1,$truthy($a=by_lines.$keys().$max())?$a:1,!1),"map",[],((TMP_23=function(line){var $b,TMP_24,self=TMP_23.$$s||this,generated_column=nil;return null==line&&(line=nil),generated_column=0,$send($truthy($b=by_lines["$[]"](line))?$b:[],"map",[],((TMP_24=function(mapping){TMP_24.$$s;var group=nil;return null==mapping&&(mapping=nil),(group=[])["$<<"]($rb_minus(mapping.$generated().$column(),generated_column)),group["$<<"]($rb_minus(sources_index["$[]"](mapping.$source()),source_id)),group["$<<"]($rb_minus(mapping.$original().$line(),source_line)),group["$<<"]($rb_minus(mapping.$original().$column(),source_column)),$truthy(mapping.$name())&&group["$<<"]($rb_minus(names_index["$[]"](mapping.$name()),name_id)),generated_column=mapping.$generated().$column(),source_id=sources_index["$[]"](mapping.$source()),source_line=mapping.$original().$line(),source_column=mapping.$original().$column(),$truthy(mapping.$name())&&(name_id=names_index["$[]"](mapping.$name())),group}).$$s=self,TMP_24.$$arity=1,TMP_24))}).$$s=this,TMP_23.$$arity=1,TMP_23)),Opal.const_get_relative($nesting,"VLQ").$encode_mappings(ary)},TMP_Map_build_vlq_string_25.$$arity=0)}($nesting[0],0,$nesting)}($nesting[0],$nesting)},Opal.modules["source_map/version"]=function(Opal){Opal.top;var $nesting=[],$module=(Opal.nil,Opal.breaker,Opal.slice,Opal.module);return function($base,$parent_nesting){var self=$module($base,"SourceMap"),$nesting=(self.$$proto,[self].concat($parent_nesting));Opal.const_set($nesting[0],"VERSION","0.0.2")}($nesting[0],$nesting)},Opal.modules.source_map=function(Opal){var self=Opal.top;Opal.nil,Opal.breaker,Opal.slice;return Opal.add_stubs(["$require"]),self.$require("source_map/map"),self.$require("source_map/mapping"),self.$require("source_map/offset"),self.$require("source_map/version"),self.$require("source_map/vlq")},Opal.modules["opal/source_map"]=function(Opal){function $rb_plus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs+rhs:lhs["$+"](rhs)}var self=Opal.top,$nesting=[],nil=Opal.nil,$module=(Opal.breaker,Opal.slice,Opal.module),$klass=Opal.klass,$truthy=Opal.truthy,$send=Opal.send;return Opal.add_stubs(["$require","$attr_reader","$+","$file","$map","$line","$column","$code","$new","$source_map_name","$count","$>","$-","$size","$rindex","$any?","$compact","$as_json","$to_s"]),self.$require("source_map"),function($base,$parent_nesting){var self=$module($base,"Opal"),$nesting=(self.$$proto,[self].concat($parent_nesting));!function($base,$super,$parent_nesting){function $SourceMap(){}var TMP_SourceMap_initialize_1,TMP_SourceMap_map_3,TMP_SourceMap_as_json_4,TMP_SourceMap_to_json_5,TMP_SourceMap_to_s_6,TMP_SourceMap_magic_comment_7,self=$SourceMap=$klass($base,null,"SourceMap",$SourceMap),def=self.$$proto;[self].concat($parent_nesting);def.map=def.fragments=nil,self.$attr_reader("fragments"),self.$attr_reader("file"),Opal.defn(self,"$initialize",TMP_SourceMap_initialize_1=function(fragments,file){return this.fragments=fragments,this.file=file},TMP_SourceMap_initialize_1.$$arity=2),Opal.defn(self,"$map",TMP_SourceMap_map_3=function(){var $a,$b,TMP_2,source_file=nil,generated_line=nil,generated_column=nil,mappings=nil,zero_offset=nil;return this.map=$truthy($a=this.map)?$a:(source_file=$rb_plus(this.$file(),".rb"),generated_line=($b=[1,0])[0],generated_column=$b[1],mappings=$send(this.fragments,"map",[],((TMP_2=function(fragment){TMP_2.$$s;var $c,source_line,source_column,new_lines,lhs,rhs,mapping=nil,source_code=nil,source_offset=nil,generated_offset=nil;return null==fragment&&(fragment=nil),mapping=nil,source_line=fragment.$line(),source_column=fragment.$column(),source_code=fragment.$code(),$truthy($truthy($c=source_line)?source_column:$c)&&(source_offset=Opal.const_get_qualified(Opal.const_get_qualified("::","SourceMap"),"Offset").$new(source_line,source_column),generated_offset=Opal.const_get_qualified(Opal.const_get_qualified("::","SourceMap"),"Offset").$new(generated_line,generated_column),mapping=Opal.const_get_qualified(Opal.const_get_qualified("::","SourceMap"),"Mapping").$new(source_file,generated_offset,source_offset,fragment.$source_map_name())),new_lines=source_code.$count("\n"),generated_line=$rb_plus(generated_line,new_lines),generated_column=$truthy((rhs=0,"number"==typeof(lhs=new_lines)&&"number"==typeof rhs?lhs>rhs:lhs["$>"](rhs)))?function(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs)}(source_code.$size(),$rb_plus(source_code.$rindex("\n"),1)):$rb_plus(generated_column,source_code.$size()),mapping}).$$s=this,TMP_2.$$arity=1,TMP_2)),$truthy(mappings["$any?"]())||(zero_offset=Opal.const_get_qualified(Opal.const_get_qualified("::","SourceMap"),"Offset").$new(0,0),mappings=[Opal.const_get_qualified(Opal.const_get_qualified("::","SourceMap"),"Mapping").$new(source_file,zero_offset,zero_offset)]),Opal.const_get_qualified(Opal.const_get_qualified("::","SourceMap"),"Map").$new(mappings.$compact()))},TMP_SourceMap_map_3.$$arity=0),Opal.defn(self,"$as_json",TMP_SourceMap_as_json_4=function(){return this.$map().$as_json()},TMP_SourceMap_as_json_4.$$arity=0),Opal.defn(self,"$to_json",TMP_SourceMap_to_json_5=function(){return this.$map().$as_json()},TMP_SourceMap_to_json_5.$$arity=0),Opal.defn(self,"$to_s",TMP_SourceMap_to_s_6=function(){return this.$map().$to_s()},TMP_SourceMap_to_s_6.$$arity=0),Opal.defn(self,"$magic_comment",TMP_SourceMap_magic_comment_7=function(map_path){return"\n//# sourceMappingURL=file://"+map_path},TMP_SourceMap_magic_comment_7.$$arity=1)}($nesting[0],0,$nesting)}($nesting[0],$nesting)},Opal.modules["opal-source-maps"]=function(Opal){var self=Opal.top;Opal.nil,Opal.breaker,Opal.slice;return Opal.add_stubs(["$require"]),self.$require("source_map"),self.$require("opal/source_map")};
