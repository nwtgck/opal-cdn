Opal.modules.logger=function(Opal){function $rb_le(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs<=rhs:lhs["$<="](rhs)}Opal.top;var $nesting=[],nil=Opal.nil,$$$=Opal.const_get_qualified,$$=Opal.const_get_relative,$klass=(Opal.breaker,Opal.slice,Opal.klass),$module=Opal.module,$send=Opal.send,$truthy=Opal.truthy;return Opal.add_stubs(["$include","$to_h","$map","$constants","$const_get","$to_s","$format","$chr","$strftime","$message_as_string","$===","$+","$message","$class","$join","$backtrace","$inspect","$attr_reader","$attr_accessor","$new","$key","$upcase","$raise","$add","$to_proc","$<=","$<","$write","$call","$[]","$now"]),function($base,$super,$parent_nesting){function $Logger(){}var TMP_Logger_1,TMP_Logger_initialize_4,TMP_Logger_level$eq_5,TMP_Logger_info_6,TMP_Logger_debug_7,TMP_Logger_warn_8,TMP_Logger_error_9,TMP_Logger_fatal_10,TMP_Logger_unknown_11,TMP_Logger_info$q_12,TMP_Logger_debug$q_13,TMP_Logger_warn$q_14,TMP_Logger_error$q_15,TMP_Logger_fatal$q_16,TMP_Logger_add_17,self=$Logger=$klass($base,null,"Logger",$Logger),def=self.prototype,$nesting=[self].concat($parent_nesting);return def.level=def.progname=def.pipe=def.formatter=nil,function($base,$parent_nesting){function $Severity(){}var self=$Severity=$module($base,"Severity",$Severity),$nesting=(self.prototype,[self].concat($parent_nesting));Opal.const_set($nesting[0],"DEBUG",0),Opal.const_set($nesting[0],"INFO",1),Opal.const_set($nesting[0],"WARN",2),Opal.const_set($nesting[0],"ERROR",3),Opal.const_set($nesting[0],"FATAL",4),Opal.const_set($nesting[0],"UNKNOWN",5)}($nesting[0],$nesting),self.$include($$($nesting,"Severity")),Opal.const_set($nesting[0],"SEVERITY_LABELS",$send($$($nesting,"Severity").$constants(),"map",[],(TMP_Logger_1=function(s){TMP_Logger_1.$$s;return null==s&&(s=nil),[$$($nesting,"Severity").$const_get(s),s.$to_s()]},TMP_Logger_1.$$s=self,TMP_Logger_1.$$arity=1,TMP_Logger_1)).$to_h()),function($base,$super,$parent_nesting){function $Formatter(){}var TMP_Formatter_call_2,TMP_Formatter_message_as_string_3,self=$Formatter=$klass($base,null,"Formatter",$Formatter),$nesting=(self.prototype,[self].concat($parent_nesting));Opal.const_set($nesting[0],"MESSAGE_FORMAT","%s, [%s] %5s -- %s: %s\n"),Opal.const_set($nesting[0],"DATE_TIME_FORMAT","%Y-%m-%dT%H:%M:%S.%6N"),Opal.def(self,"$call",TMP_Formatter_call_2=function(severity,time,progname,msg){return this.$format($$($nesting,"MESSAGE_FORMAT"),severity.$chr(),time.$strftime($$($nesting,"DATE_TIME_FORMAT")),severity,progname,this.$message_as_string(msg))},TMP_Formatter_call_2.$$arity=4),Opal.def(self,"$message_as_string",TMP_Formatter_message_as_string_3=function(msg){var $a,lhs,rhs,$case=nil;return $case=msg,$$$("::","String")["$==="]($case)?msg:$$$("::","Exception")["$==="]($case)?(lhs=msg.$message()+" ("+msg.$class()+")\n",rhs=($truthy($a=msg.$backtrace())?$a:[]).$join("\n"),"number"==typeof lhs&&"number"==typeof rhs?lhs+rhs:lhs["$+"](rhs)):msg.$inspect()},TMP_Formatter_message_as_string_3.$$arity=1)}($nesting[0],0,$nesting),self.$attr_reader("level"),self.$attr_accessor("progname"),self.$attr_accessor("formatter"),Opal.def(self,"$initialize",TMP_Logger_initialize_4=function(pipe){return this.pipe=pipe,this.level=$$($nesting,"DEBUG"),this.formatter=$$($nesting,"Formatter").$new()},TMP_Logger_initialize_4.$$arity=1),Opal.def(self,"$level=",TMP_Logger_level$eq_5=function(severity){var level=nil;return $truthy($$$("::","Integer")["$==="](severity))?this.level=severity:$truthy(level=$$($nesting,"SEVERITY_LABELS").$key(severity.$to_s().$upcase()))?this.level=level:this.$raise($$($nesting,"ArgumentError"),"invalid log level: "+severity)},TMP_Logger_level$eq_5.$$arity=1),Opal.def(self,"$info",TMP_Logger_info_6=function(progname){var $iter=TMP_Logger_info_6.$$p,block=$iter||nil;return $iter&&(TMP_Logger_info_6.$$p=null),$iter&&(TMP_Logger_info_6.$$p=null),null==progname&&(progname=nil),$send(this,"add",[$$($nesting,"INFO"),nil,progname],block.$to_proc())},TMP_Logger_info_6.$$arity=-1),Opal.def(self,"$debug",TMP_Logger_debug_7=function(progname){var $iter=TMP_Logger_debug_7.$$p,block=$iter||nil;return $iter&&(TMP_Logger_debug_7.$$p=null),$iter&&(TMP_Logger_debug_7.$$p=null),null==progname&&(progname=nil),$send(this,"add",[$$($nesting,"DEBUG"),nil,progname],block.$to_proc())},TMP_Logger_debug_7.$$arity=-1),Opal.def(self,"$warn",TMP_Logger_warn_8=function(progname){var $iter=TMP_Logger_warn_8.$$p,block=$iter||nil;return $iter&&(TMP_Logger_warn_8.$$p=null),$iter&&(TMP_Logger_warn_8.$$p=null),null==progname&&(progname=nil),$send(this,"add",[$$($nesting,"WARN"),nil,progname],block.$to_proc())},TMP_Logger_warn_8.$$arity=-1),Opal.def(self,"$error",TMP_Logger_error_9=function(progname){var $iter=TMP_Logger_error_9.$$p,block=$iter||nil;return $iter&&(TMP_Logger_error_9.$$p=null),$iter&&(TMP_Logger_error_9.$$p=null),null==progname&&(progname=nil),$send(this,"add",[$$($nesting,"ERROR"),nil,progname],block.$to_proc())},TMP_Logger_error_9.$$arity=-1),Opal.def(self,"$fatal",TMP_Logger_fatal_10=function(progname){var $iter=TMP_Logger_fatal_10.$$p,block=$iter||nil;return $iter&&(TMP_Logger_fatal_10.$$p=null),$iter&&(TMP_Logger_fatal_10.$$p=null),null==progname&&(progname=nil),$send(this,"add",[$$($nesting,"FATAL"),nil,progname],block.$to_proc())},TMP_Logger_fatal_10.$$arity=-1),Opal.def(self,"$unknown",TMP_Logger_unknown_11=function(progname){var $iter=TMP_Logger_unknown_11.$$p,block=$iter||nil;return $iter&&(TMP_Logger_unknown_11.$$p=null),$iter&&(TMP_Logger_unknown_11.$$p=null),null==progname&&(progname=nil),$send(this,"add",[$$($nesting,"UNKNOWN"),nil,progname],block.$to_proc())},TMP_Logger_unknown_11.$$arity=-1),Opal.def(self,"$info?",TMP_Logger_info$q_12=function(){return $rb_le(this.level,$$($nesting,"INFO"))},TMP_Logger_info$q_12.$$arity=0),Opal.def(self,"$debug?",TMP_Logger_debug$q_13=function(){return $rb_le(this.level,$$($nesting,"DEBUG"))},TMP_Logger_debug$q_13.$$arity=0),Opal.def(self,"$warn?",TMP_Logger_warn$q_14=function(){return $rb_le(this.level,$$($nesting,"WARN"))},TMP_Logger_warn$q_14.$$arity=0),Opal.def(self,"$error?",TMP_Logger_error$q_15=function(){return $rb_le(this.level,$$($nesting,"ERROR"))},TMP_Logger_error$q_15.$$arity=0),Opal.def(self,"$fatal?",TMP_Logger_fatal$q_16=function(){return $rb_le(this.level,$$($nesting,"FATAL"))},TMP_Logger_fatal$q_16.$$arity=0),Opal.def(self,"$add",TMP_Logger_add_17=function(severity,message,progname){var $a,lhs,rhs,$iter=TMP_Logger_add_17.$$p,block=$iter||nil;return $iter&&(TMP_Logger_add_17.$$p=null),$iter&&(TMP_Logger_add_17.$$p=null),null==message&&(message=nil),null==progname&&(progname=nil),!!$truthy((lhs=severity=$truthy($a=severity)?$a:$$($nesting,"UNKNOWN"),rhs=this.level,"number"==typeof lhs&&"number"==typeof rhs?lhs<rhs:lhs["$<"](rhs)))||(progname=$truthy($a=progname)?$a:this.progname,$truthy(message)||(block!==nil?message=Opal.yieldX(block,[]):(message=progname,progname=this.progname)),this.pipe.$write(this.formatter.$call($truthy($a=$$($nesting,"SEVERITY_LABELS")["$[]"](severity))?$a:"ANY",$$$("::","Time").$now(),progname,message)),!0)},TMP_Logger_add_17.$$arity=-2),nil&&"add"}($nesting[0],0,$nesting)};
