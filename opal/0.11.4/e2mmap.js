/* Generated by Opal 0.11.99.dev */
Opal.modules["e2mmap"] = function(Opal) {
  function $rb_lt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);
  }
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.const_get_qualified, $$ = Opal.const_get_relative, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $send = Opal.send, $truthy = Opal.truthy, $hash2 = Opal.hash2, $gvars = Opal.gvars;

  Opal.add_stubs(['$<', '$bind', '$module_eval', '$Raise', '$class', '$extend', '$def_e2message', '$def_exception', '$instance_eval', '$[]=', '$-', '$new', '$const_defined?', '$remove_const', '$const_set', '$e2mm_message', '$nil?', '$caller', '$=~', '$[]', '$quote', '$shift', '$raise', '$sprintf', '$Fail', '$inspect', '$each', '$ancestors']);
  return (function($base, $parent_nesting) {
    function $Exception2MessageMapper() {};
    var self = $Exception2MessageMapper = $module($base, 'Exception2MessageMapper', $Exception2MessageMapper);

    var def = self.prototype, $nesting = [self].concat($parent_nesting), TMP_Exception2MessageMapper_extend_object_1, TMP_Exception2MessageMapper_bind_2, TMP_Exception2MessageMapper_Raise_6, TMP_Exception2MessageMapper_def_e2message_7, TMP_Exception2MessageMapper_def_exception_8, TMP_Exception2MessageMapper_def_e2message_9, TMP_Exception2MessageMapper_def_exception_11, TMP_Exception2MessageMapper_Raise_14, TMP_Exception2MessageMapper_e2mm_message_15;

    
    Opal.const_set($nesting[0], 'E2MM', $$($nesting, 'Exception2MessageMapper'));
    Opal.defs($$($nesting, 'E2MM'), '$extend_object', TMP_Exception2MessageMapper_extend_object_1 = function $$extend_object(cl) {
      var $iter = TMP_Exception2MessageMapper_extend_object_1.$$p, $yield = $iter || nil, self = this, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

      if ($iter) TMP_Exception2MessageMapper_extend_object_1.$$p = null;
      // Prepare super implicit arguments
      for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
        $zuper[$zuper_i] = arguments[$zuper_i];
      }
      
      $send(self, Opal.find_super_dispatcher(self, 'extend_object', TMP_Exception2MessageMapper_extend_object_1, false, $Exception2MessageMapper), $zuper, $iter);
      if ($truthy($rb_lt(cl, $$($nesting, 'E2MM')))) {
        return nil
      } else {
        return cl.$bind(self)
      };
    }, TMP_Exception2MessageMapper_extend_object_1.$$arity = 1);
    
    Opal.def(self, '$bind', TMP_Exception2MessageMapper_bind_2 = function $$bind(cl) {
      var TMP_3, self = this;

      return $send(self, 'module_eval', [], (TMP_3 = function(){var self = TMP_3.$$s || this, TMP_Raise_4, TMP_included_5;

      
        
        Opal.def(self, '$Raise', TMP_Raise_4 = function $$Raise($a, $b) {
          var $post_args, err, rest, self = this;

          
          
          $post_args = Opal.slice.call(arguments, 0, arguments.length);
          
          if ($post_args.length > 0) {
            err = $post_args[0];
            $post_args.splice(0, 1);
          }
          if (err == null) {
            err = nil;
          };
          
          rest = $post_args;;
          return $send($$($nesting, 'Exception2MessageMapper'), 'Raise', [self.$class(), err].concat(Opal.to_a(rest)));
        }, TMP_Raise_4.$$arity = -1);
        Opal.alias(self, "Fail", "Raise");
        (function(self, $parent_nesting) {
          var def = self.prototype, $nesting = [self].concat($parent_nesting);

          
          
          Opal.udef(self, '$' + "included");;
          return nil;
        })(Opal.get_singleton_class(self), $nesting);
        return (Opal.defs(self, '$included', TMP_included_5 = function $$included(mod) {
          var self = this;

          return mod.$extend($$($nesting, 'Exception2MessageMapper'))
        }, TMP_included_5.$$arity = 1), nil) && 'included';}, TMP_3.$$s = self, TMP_3.$$arity = 0, TMP_3))
    }, TMP_Exception2MessageMapper_bind_2.$$arity = 1);
    
    Opal.def(self, '$Raise', TMP_Exception2MessageMapper_Raise_6 = function $$Raise($a, $b) {
      var $post_args, err, rest, self = this;

      
      
      $post_args = Opal.slice.call(arguments, 0, arguments.length);
      
      if ($post_args.length > 0) {
        err = $post_args[0];
        $post_args.splice(0, 1);
      }
      if (err == null) {
        err = nil;
      };
      
      rest = $post_args;;
      return $send($$($nesting, 'E2MM'), 'Raise', [self, err].concat(Opal.to_a(rest)));
    }, TMP_Exception2MessageMapper_Raise_6.$$arity = -1);
    Opal.alias(self, "Fail", "Raise");
    Opal.alias(self, "fail", "Raise");
    
    Opal.def(self, '$def_e2message', TMP_Exception2MessageMapper_def_e2message_7 = function $$def_e2message(c, m) {
      var self = this;

      return $$($nesting, 'E2MM').$def_e2message(self, c, m)
    }, TMP_Exception2MessageMapper_def_e2message_7.$$arity = 2);
    
    Opal.def(self, '$def_exception', TMP_Exception2MessageMapper_def_exception_8 = function $$def_exception(n, m, s) {
      var self = this;

      
      
      if (s == null) {
        s = $$($nesting, 'StandardError');
      };
      return $$($nesting, 'E2MM').$def_exception(self, n, m, s);
    }, TMP_Exception2MessageMapper_def_exception_8.$$arity = -3);
    self.MessageMap = $hash2([], {});
    Opal.defs($$($nesting, 'E2MM'), '$def_e2message', TMP_Exception2MessageMapper_def_e2message_9 = function $$def_e2message(k, c, m) {
      var TMP_10, self = this;

      
      $send($$($nesting, 'E2MM'), 'instance_eval', [], (TMP_10 = function(){var self = TMP_10.$$s || this, $writer = nil;
        if (self.MessageMap == null) self.MessageMap = nil;

      
        $writer = [[k, c], m];
        $send(self.MessageMap, '[]=', Opal.to_a($writer));
        return $writer[$rb_minus($writer["length"], 1)];}, TMP_10.$$s = self, TMP_10.$$arity = 0, TMP_10));
      return c;
    }, TMP_Exception2MessageMapper_def_e2message_9.$$arity = 3);
    Opal.defs($$($nesting, 'E2MM'), '$def_exception', TMP_Exception2MessageMapper_def_exception_11 = function $$def_exception(k, n, m, s) {
      var TMP_12, TMP_13, self = this, e = nil;

      
      
      if (s == null) {
        s = $$($nesting, 'StandardError');
      };
      e = $$($nesting, 'Class').$new(s);
      $send($$($nesting, 'E2MM'), 'instance_eval', [], (TMP_12 = function(){var self = TMP_12.$$s || this, $writer = nil;
        if (self.MessageMap == null) self.MessageMap = nil;

      
        $writer = [[k, e], m];
        $send(self.MessageMap, '[]=', Opal.to_a($writer));
        return $writer[$rb_minus($writer["length"], 1)];}, TMP_12.$$s = self, TMP_12.$$arity = 0, TMP_12));
      if ($truthy(k['$const_defined?'](n, false))) {
        $send(k, 'module_eval', [], (TMP_13 = function(){var self = TMP_13.$$s || this;

        return self.$remove_const(n)}, TMP_13.$$s = self, TMP_13.$$arity = 0, TMP_13))};
      return k.$const_set(n, e);
    }, TMP_Exception2MessageMapper_def_exception_11.$$arity = -4);
    Opal.defs($$($nesting, 'E2MM'), '$Raise', TMP_Exception2MessageMapper_Raise_14 = function $$Raise($a, $b, $c) {
      var $post_args, klass, err, rest, self = this, form = nil, b = nil;
      if ($gvars["@"] == null) $gvars["@"] = nil;

      
      
      $post_args = Opal.slice.call(arguments, 0, arguments.length);
      
      if ($post_args.length > 0) {
        klass = $post_args[0];
        $post_args.splice(0, 1);
      }
      if (klass == null) {
        klass = $$($nesting, 'E2MM');
      };
      
      if ($post_args.length > 0) {
        err = $post_args[0];
        $post_args.splice(0, 1);
      }
      if (err == null) {
        err = nil;
      };
      
      rest = $post_args;;
      if ($truthy((form = self.$e2mm_message(klass, err)))) {
        
        b = (function() {if ($truthy($gvars["@"]['$nil?']())) {
          return self.$caller(1)
        } else {
          return $gvars["@"]
        }; return nil; })();
        if ($truthy(b['$[]'](0)['$=~'](new RegExp("" + "^" + ($$($nesting, 'Regexp').$quote("./e2mmap.rb".$force_encoding("US-ASCII"))) + ":")))) {
          b.$shift()};
        return self.$raise(err, $send(self, 'sprintf', [form].concat(Opal.to_a(rest))), b);
      } else {
        return $$($nesting, 'E2MM').$Fail($$($nesting, 'E2MM'), $$($nesting, 'ErrNotRegisteredException'), err.$inspect())
      };
    }, TMP_Exception2MessageMapper_Raise_14.$$arity = -1);
    (function(self, $parent_nesting) {
      var def = self.prototype, $nesting = [self].concat($parent_nesting);

      return Opal.alias(self, "Fail", "Raise")
    })(Opal.get_singleton_class($$($nesting, 'E2MM')), $nesting);
    Opal.defs($$($nesting, 'E2MM'), '$e2mm_message', TMP_Exception2MessageMapper_e2mm_message_15 = function $$e2mm_message(klass, exp) {try {

      var TMP_16, self = this;

      
      $send(klass.$ancestors(), 'each', [], (TMP_16 = function(c){var self = TMP_16.$$s || this, mes = nil;
        if (self.MessageMap == null) self.MessageMap = nil;

      
        
        if (c == null) {
          c = nil;
        };
        if ($truthy((mes = self.MessageMap['$[]']([c, exp])))) {
          Opal.ret(mes)
        } else {
          return nil
        };}, TMP_16.$$s = self, TMP_16.$$arity = 1, TMP_16));
      return nil;
      } catch ($returner) { if ($returner === Opal.returner) { return $returner.$v } throw $returner; }
    }, TMP_Exception2MessageMapper_e2mm_message_15.$$arity = 2);
    (function(self, $parent_nesting) {
      var def = self.prototype, $nesting = [self].concat($parent_nesting);

      return Opal.alias(self, "message", "e2mm_message")
    })(Opal.get_singleton_class(self), $nesting);
    $$($nesting, 'E2MM').$def_exception($$($nesting, 'E2MM'), "ErrNotRegisteredException", "not registered exception(%s)");
  })($nesting[0], $nesting)
};
